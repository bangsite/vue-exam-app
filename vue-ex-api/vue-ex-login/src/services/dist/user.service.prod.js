"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.userService=void 0;var _config=_interopRequireDefault(require("config")),_helpers=require("../helpers");function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}var userService={login:login,logout:logout,register:register,getAll:getAll,getById:getById,update:update,delete:_delete};function login(e,t){var r={method:"POST",headers:{"Content-type":"application/json"},body:JSON.stringify({username:e,password:t})};return fetch("".concat(_config.default.apiUrl,"/users/authenticate"),r).then(handleResponse).then(function(e){return e.token&&localStorage.setItem("user",JSON.stringify(e)),e})}function logout(){localStorage.removeItem("user")}function register(e){var t={method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({user:e})};return fetch("".concat(_config.default.apiUrl,"/user/register"),t).then(handleResponse)}function getAll(){(0,_helpers.authHeader)()}function getById(e){var t={method:"GET",headers:(0,_helpers.authHeader)()};return fetch("".concat(_config.default.apiUrl,"/users/").concat(id),t).then(handleResponse)}function _delete(e){var t={method:"DELETE",headers:(0,_helpers.authHeader)()};return fetch("".concat(_config.default.apiUrl,"/users/").concat(e),t).then(handleResponse)}function handleResponse(n){return n.text().then(function(e){var t=e&&JSON.parse(e);if(n.ok)return t;401===n.status&&(logout(),location.reload(!0));var r=t&&t.message||n.statusText;return Promise.reject(r)})}exports.userService=userService;